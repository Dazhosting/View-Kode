const axios = require('axios');
const cheerio = require('cheerio');

async function searchCodeShare(query = 'web') {
  try {
    const url = `https://codeshare.cloudku.click/?q=${encodeURIComponent(query)}`;
    const { data: html } = await axios.get(url);
    const $ = cheerio.load(html);
    const results = [];

    $('.snippet-card').each((i, el) => {
      const title = $(el).find('.card-title a').text().trim();
      const link = 'https://codeshare.cloudku.click' + $(el).find('.card-title a').attr('href');
      const username = $(el).find('.user-info').text().trim();
      const views = $(el).find('.meta-item').first().text().trim();
      const language = $(el).find('.meta-item i').attr('class')?.split('-').pop();

      results.push({ title, link, username, views, language });
    });

    return results;
  } catch (err) {
    console.error('❌ Error saat scraping:', err.message);
    return [];
  }
}

Contoh penggunaan:
(async () => {
  const snippets = await searchCodeShare('web');
  console.log(snippets);
})();
